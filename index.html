<!DOCTYPE html>
<html manifest="cache.appcache">
  <head>
    <title>Scott Fryxell</title>
    <meta charset="utf-8">
    <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <link rel="stylesheet" href="/application.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato">
    <link rel="canonical"  href="https://scott-fryxell.github.io/">
    <script src="/scripts/vue.js"></script>
    <script src="/scripts/Item.js"></script>
    <script src="/scripts/timeago.js"></script>
    <script src="https://www.gstatic.com/firebasejs/4.3.1/firebase.js"></script>
  </head>
  <body class='developer'>
    <header>
      <a tabindex="-1" href="/"><svg id="logo"><use xlink:href="/application.svg#logo"/></svg></a>
      <nav>
        <a tabindex="-1" href="/resume">CV</a>
        <a tabindex="-1" href="https://cash.me/$ScottFryxell" target="_blank">$</a>
      </nav>
    </header>
    <main>
      <section id="posts">
  <header>
    <textarea tabindex="1" placeholder="Wat?" v-model="new_post" v-on:focusout="addPost"></textarea>
  </header>
  <section itemscope itemtype="http://schema.org/blog">
    <article v-for="post in posts" itemscope itemtype="http://schema.org/SocialMediaPosting">
      <header><time itemprop="created_at" :datetime="post.created_at"></time></header>
      <p itemprop="articleBody">{{post.articleBody}}</p>
    </article>
  </section>
 </section>
<script id="app">
  var storage = {
    key: "some-posts",
    save() {
      var posts = document.querySelector('[itemtype="http://schema.org/blog"]').innerHTML
      localStorage.setItem(storage.key, posts)
    },
    load() {
      let posts_string =  localStorage.getItem(this.key)
      let posts = document.createRange().createContextualFragment(posts_string)
      posts.getItems = Item.get_items
      return posts.getItems('http://schema.org/SocialMediaPosting')
    }
  }
  var app = new Vue({
    el:   'section#posts',
    data: {
      posts: storage.load(),
      new_post: ''
    },
    methods: {
      addPost() {
        let value = this.new_post && this.new_post.trim()
        if (!value) { return }
        this.posts.push({
          articleBody: value,
          created_at: new Date().toISOString()
        })
        this.new_post = ''
        storage.save()
      }
    },

    watch: {
      posts() {
        Vue.nextTick( () => {
          storage.save()
        })
      }
    }
  })
</script>
    </main>
    <footer>
      <details class="style">
        <summary>
          <svg id="style"><use xlink:href="/application.svg#leaf"/></svg>
          <h5>Style</h5>
        </summary>
        <style media="screen">
          * remove {
            outline: 1px solid hsla(203, 58%, 57%, 0.9);
          }
        </style>
      </details>
      <details class="script">
        <summary>
          <svg id="script"><use xlink:href="/application.svg#leaf"/></svg>
          <h5>Script</h5>
        </summary>
        <script type="text/javascript" >
          document.body.addEventListener('keydown', function(keydown) {
            var enter = 13;
            if(keydown.keyCode == enter && keydown.metaKey) {
              var content = document.querySelector("body")
              if( content.isContentEditable ) {
                content.removeAttribute("contenteditable");
              } else {
                content.setAttribute("contenteditable",  true);
              }
            }
          });
        </script>
      </details>
    </footer>
  </body>

</html>
